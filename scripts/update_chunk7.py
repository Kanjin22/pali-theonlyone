import json
import re

file_path = r'd:\pali-theonlyone\data\raw\vocab-insan-pr9-5-8.js'

with open(file_path, 'r', encoding='utf-8') as f:
    lines = f.readlines()

new_lines = []
skip_next = False

for i, line in enumerate(lines):
    if skip_next:
        skip_next = False
        continue

    stripped = line.strip()

    # 1. Update อาคมนกิจฺจ
    if '"อาคมนกิจฺจ":' in line:
        new_lines.append('  "อาคมนกิจฺจ": "น., นปุ. กิจคืออันมา แจกเหมือน กุล เช่น ป. เอก. อาคมนกิจฺจํ อ. กิจคืออันมา เป็น อวธารณบุพพบท กัมมธารยสมาส วิ. ว่า อาคมนํ เอว กิจฺจํ = อาคมนกิจฺจํ",\n')
        continue

    # 2. Update อาคมนตฺถาย
    if '"อาคมนตฺถาย":' in line:
        new_lines.append('  "อาคมนตฺถาย": "น., ปุ. เพื่อประโยชน์แก่การมา (อาคมน + อตฺถ ประโยชน์) ศัพท์เดิมเป็น อาคมนตฺถ อ การันต์ ในปุงลิงค์ ลง ส จตุตถี วิภัตติ ฝ่ายเอกวจนะ แปลง อ กับ ส เป็น อาย สำเร็จรูปเป็น อาคมนตฺถาย แจกเหมือน ปุริส เป็นจตุตถีตัปปุริสสมาส วิ. ว่า อาคมนสฺส อตฺโถ = อาคมนตฺโถ",\n')
        continue

    # 3. Update อาคมนทิวส
    if '"อาคมนทิวส":' in line:
        new_lines.append('  "อาคมนทิวส": "น., ปุ. วันเป็นที่มา แจกเหมือน ปุริส เช่น ป. เอก. อาคมนทิวโส อ. วันเป็นที่มา เป็น วิเสสนบุพพบท กัมมธารยสมาส วิ. ว่า อาคมโน ทิวโส = อาคมนทิวโส คำว่า อาคมน ในคำว่า อาคมนทิวโส มาจาก อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + ยุ ปัจจัย แปลง ยุ เป็น อน ได้รูปเป็น อาคมน แปลว่า เป็นที่มา เป็นกัตตุรูป อธิกรณสาธนะ วิ. ว่า อาคจฺฉติ เอตฺถาติอาคมโน (ทิวโส) เขา ย่อมมา ในวันนั่น เหตุนั้น วันนั่น ชื่อว่า อาคมโนๆ เป็นที่มา",\n')
        continue

    # 4. Merge พระอเสขะ into อาคมนปฺปฏิปทา
    if '"อาคมนปฺปฏิปทา":' in line:
        # Check if next line is พระอเสขะ
        if i + 1 < len(lines) and '"พระอเสขะ":' in lines[i+1]:
             content_part1 = "น., อิต. ปฏิปทาเป็นเหตุมา แจกเหมือน กญฺญา เช่น ทุ. เอก. อาคมนปฺปฏิปทํ ซึ่งปฏิปทาเป็นเหตุมา [ธ. ๖: ยมกปฺปาฏิหาริยวตฺถุ หน้า ๙๒] เป็นวิเสสนบุพพบท กัมมธารยสมาส วิ. ว่า อาคมนา ปฏิปทา = อาคมนปฺปฏิปทา [ซ้อน ปฺ]คำว่า อาคมน ในคำว่า อาคมนปฺปฏิปทํ มาจาก อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + ยุ ปัจจัย แปลง ยุ เป็น อน ได้รูปเป็น อาคมน แปลว่า เป็นเหตุมา เป็น กัตตุรูป กรณสาธนะ วิ. ว่า อาคจฺฉนฺติ เอตายาติอาคมนา (ปฏิปทา) พระเสขะและ พระอเสขะ ท. ย่อมมา ด้วยปฏิปทานั่น เหตุนั้น ปฏิปทานั่น ชื่อว่า อาคมนาๆ เป็นเหตุมา"
             new_lines.append(f'  "อาคมนปฺปฏิปทา": "{content_part1}",\n')
             skip_next = True # Skip พระอเสขะ line
             continue
        else:
            # Fallback if structure is unexpected, though we saw it in Read output
             new_lines.append('  "อาคมนปฺปฏิปทา": "น., อิต. ปฏิปทาเป็นเหตุมา แจกเหมือน กญฺญา เช่น ทุ. เอก. อาคมนปฺปฏิปทํ ซึ่งปฏิปทาเป็นเหตุมา [ธ. ๖: ยมกปฺปาฏิหาริยวตฺถุ หน้า ๙๒] เป็นวิเสสนบุพพบท กัมมธารยสมาส วิ. ว่า อาคมนา ปฏิปทา = อาคมนปฺปฏิปทา [ซ้อน ปฺ]คำว่า อาคมน ในคำว่า อาคมนปฺปฏิปทํ มาจาก อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + ยุ ปัจจัย แปลง ยุ เป็น อน ได้รูปเป็น อาคมน แปลว่า เป็นเหตุมา เป็น กัตตุรูป กรณสาธนะ วิ. ว่า อาคจฺฉนฺติ เอตายาติอาคมนา (ปฏิปทา) พระเสขะและ พระอเสขะ ท. ย่อมมา ด้วยปฏิปทานั่น เหตุนั้น ปฏิปทานั่น ชื่อว่า อาคมนาๆ เป็นเหตุมา",\n')
             continue

    # 5. Fix อาคมนภาว
    if '"อาคมนภาว":' in line:
        new_lines.append('  "อาคมนภาว": "น., ปุ. ความเป็นคืออันมา แจก เหมือน ปุริส เช่น ทุ. เอก. อาคมนภาวํ ซึ่งความ เป็นคืออันมา เป็นอวธารณบุพพบท กัมมธารย สมาส วิ. ว่า อาคมนํ เอว ภาโว = อาคมนภาโว",\n')
        continue

    # 6. Update อาคมนมคฺค
    if '"อาคมนมคฺค":' in line:
        new_lines.append('  "อาคมนมคฺค": "น., ปุ. หนทางเป็นที่มา ดู อาคมน กาล",\n')
        continue

    # 7. Update อาคมยมาน
    if '"อาคมยมาน":' in line:
        new_lines.append('  "อาคมยมาน": "ก. ยัง... ให้มาอยู่ (รออยู่, รอคอยอยู่) อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + ณย ปัจจัย ในเหตุกัตตุวาจก + มาน ปัจจัย ลบ ณ เหลือไว้แต่ ย ได้รูปเป็น อาคมยมาน ดู อนิจฺฉมาน",\n')
        continue

    # 8. Merge = อาคมาธิคมา into อาคมาธิคมสมฺปนฺนํ
    if '"อาคมาธิคมสมฺปนฺนํ":' in line:
         if i + 1 < len(lines) and '"= อาคมาธิคมา":' in lines[i+1]:
             content = "ว., ปุ. (ปุคฺคลํ) ซึ่งบุคคล ผู้ถึงพร้อมแล้วด้วยนิกายเป็นที่มาและมรรค และผลเป็นที่บรรลุ เป็นตติยาตัปปุริสสมาส มี อสมาหารทวันทวสมาส เป็นภายใน มีวิเคราะห์ ตามลำดับ ดังนี้ อ. ทวัน. วิ. อาคโม จ อธิคโม จ = อาคมาธิคมา ต. ตัป. วิ. อาคมาธิคเมหิ สมฺปนฺโน = อาคมาธิคมสมฺปนฺโน (ปุคฺคโล)"
             new_lines.append(f'  "อาคมาธิคมสมฺปนฺนํ": "{content}",\n')
             skip_next = True
             continue
         else:
             new_lines.append('  "อาคมาธิคมสมฺปนฺนํ": "ว., ปุ. (ปุคฺคลํ) ซึ่งบุคคล ผู้ถึงพร้อมแล้วด้วยนิกายเป็นที่มาและมรรค และผลเป็นที่บรรลุ เป็นตติยาตัปปุริสสมาส มี อสมาหารทวันทวสมาส เป็นภายใน มีวิเคราะห์ ตามลำดับ ดังนี้ อ. ทวัน. วิ. อาคโม จ อธิคโม จ = อาคมาธิคมา ต. ตัป. วิ. อาคมาธิคเมหิ สมฺปนฺโน = อาคมาธิคมสมฺปนฺโน (ปุคฺคโล)",\n')
             continue

    # 9. Update อาคมิ
    if '"อาคมิ":' in line:
        new_lines.append('  "อาคมิ": "ก. (เช่น เถโร อ. พระเถระ) มาแล้ว อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + อ ปัจจัย ในกัตตุวาจก + อี อัชชัตตนี วิภัตติ รัสสะ อี เป็น อิ สำเร็จรูปเป็น อาคมิ",\n')
        continue

    # 10. Update อาคมิมฺห
    if '"อาคมิมฺห":' in line:
        new_lines.append('  "อาคมิมฺห": "ก. (มยํ อ. เรา ท.) มาแล้ว อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + อ ปัจจัย ในกัตตุวาจก + มฺหา อัชชัตตนีวิภัตติ ลง อิ อาคม รัสสะ อา ที่ มฺหา เป็น อ สำเร็จรูป เป็น อาคมิมฺห",\n')
        continue

    # 11. Update อาคมิมฺหา
    if '"อาคมิมฺหา":' in line:
        new_lines.append('  "อาคมิมฺหา": "ก. (มยํ อ. เรา ท.) มาแล้ว อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + อ ปัจจัย ในกัตตุวาจก + มฺหา อัชชัตตนีวิภัตติ ลง อิ อาคม สำเร็จรูปเป็น อาคมิมฺหา",\n')
        continue

    # 12. Ensure อาคมิสฺสติ and อาคมิสฺสถ exist/update
    if '"อาคมิสฺสติ":' in line:
        new_lines.append('  "อาคมิสฺสติ": "ก. (เช่น เถโร อ. พระเถระ) จักมา อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + อ ปัจจัย ในกัตตุวาจก + สฺสติ ภวิสสันติวิภัตติ ลง อิ อาคม สำเร็จรูปเป็น อาคมิสฺสติ",\n')
        continue
    
    if '"อาคมิสฺสถ":' in line:
        new_lines.append('  "อาคมิสฺสถ": "ก. (ตุมฺเห อ. ท่าน ท.) จักมา อา บทหน้า + คม ธาตุ ในความไป มี อา อยู่หน้า แปลว่า มา + อ ปัจจัย ในกัตตุวาจก + สฺสถ ภวิสสันติวิภัตติ ลง อิ อาคม สำเร็จรูปเป็น อาคมิสฺสถ",\n')
        continue

    new_lines.append(line)

with open(file_path, 'w', encoding='utf-8') as f:
    f.writelines(new_lines)

print("Updates applied successfully.")
