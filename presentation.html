<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏ö‡∏≤‡∏•‡∏µ (Interactive Text)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CSS ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô --- */
        body { margin: 0; padding: 0; background-color: #eceff1; font-family: 'Sarabun', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: #37474f; }
        
        .card { width: 95%; max-width: 1000px; height: 85vh; max-height: 800px; background-color: #ffffff; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .header-bar { height: 6px; background: linear-gradient(90deg, #263238, #546e7a, #78909c); width: 100%; flex-shrink: 0; }
        
        .content-area { flex: 1; padding: 40px 100px 20px 100px; display: flex; flex-direction: column; justify-content: flex-start; align-items: stretch; text-align: left; overflow-y: auto; }
        .content-area::-webkit-scrollbar { width: 6px; }
        .content-area::-webkit-scrollbar-thumb { background-color: #cfd8dc; border-radius: 4px; }

        /* --- CSS ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå --- */
        .word-span { cursor: pointer; display: inline; padding: 0; margin: 0; border-bottom: 2px solid transparent; transition: color 0.2s, border-color 0.2s; }
        .word-span:hover { color: #1565C0; }
        .word-span.translated { color: #1565C0; border-bottom-color: #1565C0; }
        
        .word-span.has-info { border-bottom: 2px dotted #aaa; }
        .word-span.has-info.translated { border-bottom: 2px dotted #1565C0; }

        /* --- CSS ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° --- */
        .pali-text { font-family: 'Sarabun', sans-serif; font-size: 1.8rem; color: #263238; font-weight: 600; line-height: 2; margin-bottom: 25px; text-align: left; text-indent: 50px; word-spacing: 0; letter-spacing: 0; word-break: normal; overflow-wrap: break-word; }
        
        .thai-text { 
            font-family: 'Sarabun', sans-serif; font-size: 1.3rem; color: #546e7a; font-weight: 300; line-height: 2; text-align: left; text-indent: 50px; word-break: normal; overflow-wrap: break-word; 
            transition: opacity 0.3s ease; opacity: 1; 
        }
        .thai-text.hidden { opacity: 0; user-select: none; pointer-events: none; }

        /* --- Tooltip --- */
        #sandhi-tooltip { position: fixed; display: none; background-color: #37474f; color: #fff; padding: 8px 12px; border-radius: 6px; font-size: 1.1rem; font-family: 'Sarabun', sans-serif; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 2000; pointer-events: none; white-space: nowrap; border: 1px solid #546e7a; }
        #sandhi-tooltip span.split { color: #ffca28; font-weight: bold; }
        #sandhi-tooltip span.origin { color: #b0bec5; font-size: 0.9em; margin-left: 5px; }

        /* --- ‡∏≠‡∏∑‡πà‡∏ô‡πÜ --- */
        .divider { width: 50px; height: 4px; background-color: #cfd8dc; border-radius: 2px; margin: 0 auto 25px auto; flex-shrink: 0; }
        .footer-box { background-color: #f7f9f9; border-top: 1px solid #eceff1; height: 150px; display: flex; padding: 0; flex-shrink: 0; }
        .footer-section { flex: 1; padding: 15px 25px; border-right: 1px solid #eceff1; display: flex; flex-direction: column; text-align: left; overflow-y: auto; }
        .footer-section:last-child { border-right: none; }
        .sec-title { font-size: 0.8rem; font-weight: 700; color: #90a4ae; text-transform: uppercase; margin-bottom: 8px; border-bottom: 1px solid #cfd8dc; padding-bottom: 3px; }
        .sec-content { font-size: 0.95rem; color: #37474f; line-height: 1.5; }
        .pali-word { font-family: 'Sarabun', sans-serif; color: #0277bd; font-weight: 600; }
        .page-badge { position: absolute; top: 20px; right: 20px; background-color: rgba(236, 239, 241, 0.9); padding: 6px 12px; border-radius: 8px; font-size: 0.9rem; color: #78909c; font-weight: bold; z-index: 10; }
        
        .controls { position: fixed; bottom: 25px; display: flex; gap: 20px; z-index: 100; }
        button { padding: 12px 30px; background-color: #455a64; border: none; border-radius: 50px; font-family: 'Sarabun', sans-serif; font-size: 1rem; font-weight: 600; color: #ffffff; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: all 0.3s ease; }
        button:hover { background-color: #607d8b; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.25); }

        /* ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô Card (‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≤) */
        .tool-btn { 
            position: absolute; top: 20px; right: 100px; /* ‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ */
            padding: 8px 12px; border-radius: 8px; z-index: 10;
            background-color: #eceff1; color: #546e7a; box-shadow: none;
        }
        .tool-btn:hover { background-color: #cfd8dc; transform: none; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .animate-content { animation: slideIn 0.4s ease-out forwards; }

        @media screen and (max-width: 768px) {
            .card { height: 90vh; margin-top: -40px; }
            .content-area { padding: 60px 20px 40px 20px; }
            .pali-text { font-size: 1.4rem; margin-bottom: 15px; }
            .thai-text { font-size: 1.2rem; }
            .footer-box { height: auto; flex-direction: column; overflow-y: auto; min-height: 120px; max-height: 30%; }
            .footer-section { border-right: none; border-bottom: 1px solid #eceff1; padding: 10px 20px; }
            .controls { bottom: 10px; gap: 10px; }
            button { padding: 10px 20px; font-size: 0.9rem; }
            .tool-btn { right: 80px; }
        }
    </style>
</head>
<body>

    <div class="card" id="cardContainer">
        <div class="header-bar"></div>
        <div class="page-badge" id="pageNumber">1</div>
        
        <!-- *** ‡∏õ‡∏∏‡πà‡∏°‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏• (‡∏°‡∏µ ID ‡πÅ‡∏•‡πâ‡∏ß) *** -->
        <button class="tool-btn" id="btn-toggle-thai" title="‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•" onclick="toggleThai()">
            <i class="fa-solid fa-eye"></i>
        </button>

        <div class="content-area animate-content" id="mainContent">
            <div class="pali-text" id="paliContent">...</div>
            <div class="divider"></div>
            <div class="thai-text" id="thaiContent">...</div>
        </div>

        <div class="footer-box">
            <div class="footer-section" style="flex: 1.2;">
                <div class="sec-title">üìù ‡∏ö‡∏£‡∏¥‡∏ö‡∏ó / ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</div>
                <div class="sec-content" id="contextContent">...</div>
            </div>
            <div class="footer-section" style="flex: 0.8;">
                <div class="sec-title">üîπ ‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏≠‡∏≤‡∏Ç‡∏¢‡∏≤‡∏ï (‡∏Ñ‡∏∏‡∏°‡∏û‡∏≤‡∏Å‡∏¢‡πå)</div>
                <div class="sec-content pali-word" id="akhyataContent">...</div>
            </div>
            <div class="footer-section" style="flex: 1;">
                <div class="sec-title">üî∏ ‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏Å‡∏¥‡∏ï‡∏Å‡πå / ‡∏ï ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢</div>
                <div class="sec-content pali-word" id="kitakaContent">...</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button onclick="prevSlide()">‚ùÆ ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button onclick="resetHighlights()" style="background-color: #e57373;">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <button onclick="nextSlide()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ùØ</button>
    </div>

    <div id="sandhi-tooltip"></div>

    <script src="slides-data.js"></script>

    <script>
        const params = new URLSearchParams(window.location.search);
        const slideId = params.get('id');

        let slides = [];
        if (slideId && typeof slidesDatabase !== 'undefined' && slidesDatabase[slideId]) {
            slides = slidesDatabase[slideId];
        } else {
            slides = [{ pali: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô", thai: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™ (ID)", context: "-", akhyata: "-", kitaka: "-" }];
        }

        let currentIndex = 0;
        const mainContent = document.getElementById('mainContent');
        const contentArea = document.querySelector('.content-area');
        
        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏• (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß) ---
        let isThaiHidden = false;

        function toggleThai() {
            isThaiHidden = !isThaiHidden;
            applyThaiState();
        }

        function applyThaiState() {
            const thaiElem = document.getElementById('thaiContent');
            const btn = document.getElementById('btn-toggle-thai');
            const btnIcon = btn.querySelector('i');

            if (isThaiHidden) {
                thaiElem.classList.add('hidden');
                btnIcon.classList.remove('fa-eye');
                btnIcon.classList.add('fa-eye-slash');
            } else {
                thaiElem.classList.remove('hidden');
                btnIcon.classList.remove('fa-eye-slash');
                btnIcon.classList.add('fa-eye');
            }
        }
        // --------------------------------------------------------

        function wrapWords(text, vocabData) {
            if (!text) return "";
            return text.split(' ').map(word => {
                if (word.trim() === "") return "";
                let cleanWord = word.replace(/[‡∏Ø,.]/g, ''); 
                let vocabInfo = "";
                let hasInfoClass = "";
                if (vocabData && vocabData[cleanWord]) {
                    vocabInfo = `data-sandhi="${vocabData[cleanWord]}"`;
                    hasInfoClass = "has-info";
                }
                return `<span class="word-span ${hasInfoClass}" 
                              ${vocabInfo}
                              onmouseenter="showTooltip(this)" 
                              onmouseleave="hideTooltip()"
                              onclick="toggleHighlight(this)">${word}</span>`;
            }).join(' ');
        }

        function updateSlide() {
            mainContent.classList.remove('animate-content');
            void mainContent.offsetWidth; 
            mainContent.classList.add('animate-content');
            contentArea.scrollTop = 0;

            const s = slides[currentIndex];

            document.getElementById('paliContent').innerHTML = wrapWords(s.pali, s.vocab);
            document.getElementById('thaiContent').innerHTML = wrapWords(s.thai); // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡πÑ‡∏ó‡∏¢‡∏î‡πâ‡∏ß‡∏¢
            // document.getElementById('thaiContent').innerText = s.thai; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡πÑ‡∏ó‡∏¢ ‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô
            
            document.getElementById('contextContent').innerText = s.context;
            document.getElementById('akhyataContent').innerText = s.akhyata;
            document.getElementById('kitakaContent').innerText = s.kitaka;
            
            document.getElementById('pageNumber').innerText = `${currentIndex + 1} / ${slides.length}`;

            // *** ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ***
            applyThaiState();
        }

        const tooltip = document.getElementById('sandhi-tooltip');
        function showTooltip(element) {
            const info = element.getAttribute('data-sandhi');
            if (!info) return;
            let formattedInfo = info;
            if (info.includes('(')) {
                const parts = info.split('(');
                formattedInfo = `<span class="split">${parts[0]}</span> <span class="origin">(${parts[1]}</span>`;
            } else {
                formattedInfo = `<span class="split">${info}</span>`;
            }
            tooltip.innerHTML = formattedInfo;
            tooltip.style.display = 'block';
            const rect = element.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            let top = rect.top - tooltipRect.height - 10; 
            let left = rect.left + (rect.width / 2) - (tooltipRect.width / 2); 
            if (top < 0) top = rect.bottom + 10; 
            if (left < 10) left = 10;
            tooltip.style.top = `${top}px`;
            tooltip.style.left = `${left}px`;
        }
        function hideTooltip() { tooltip.style.display = 'none'; }
        window.toggleHighlight = function(element) { element.classList.toggle('translated'); }
        window.resetHighlights = function() { document.querySelectorAll('.word-span').forEach(el => el.classList.remove('translated')); }
        function nextSlide() { if (currentIndex < slides.length - 1) { currentIndex++; updateSlide(); } }
        function prevSlide() { if (currentIndex > 0) { currentIndex--; updateSlide(); } }
        document.addEventListener('keydown', function(event) {
            if (event.key === "ArrowRight") nextSlide();
            if (event.key === "ArrowLeft") prevSlide();
        });

        updateSlide();
    </script>
</body>
</html>