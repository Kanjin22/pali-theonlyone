<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏ö‡∏≤‡∏•‡∏µ (Interactive Text)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Niramit:wght@400;500;600&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CSS ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô --- */
        body { margin: 0; padding: 0; background-color: #eceff1; font-family: 'Sarabun', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: #37474f; }
        
        .card {
            width: 95%; max-width: 1000px; height: 85vh; max-height: 800px;
            background-color: #ffffff; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            display: flex; flex-direction: column; overflow: hidden; position: relative;
        }
        
        .header-bar { height: 6px; background: linear-gradient(90deg, #263238, #546e7a, #78909c); width: 100%; flex-shrink: 0; }
        
        .content-area {
            flex: 1;
            padding: 40px 100px 20px 100px;
            display: flex; flex-direction: column;
            justify-content: flex-start; /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ö‡∏ô */
            align-items: stretch;
            text-align: left;
            overflow-y: auto;
        }
        .content-area::-webkit-scrollbar { width: 6px; }
        .content-area::-webkit-scrollbar-thumb { background-color: #cfd8dc; border-radius: 4px; }

        /* --- CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏ó‡∏µ‡πà) --- */
        .word-span {
            cursor: pointer;
            display: inline;
            padding: 0;
            margin: 0;
            border-bottom: 2px solid transparent;
            transition: color 0.2s, border-color 0.2s;
        }
        
        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ */
        .word-span:hover {
            color: #1565C0; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏≠‡∏ô‡∏ä‡∏µ‡πâ */
        }

        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å (‡πÅ‡∏õ‡∏•‡πÅ‡∏•‡πâ‡∏ß) */
        .word-span.translated {
            color: #1565C0;           /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
            border-bottom-color: #1565C0; /* ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ */
        }

        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏≤‡∏•‡∏µ */
        .pali-text {
            font-family: 'Sarabun', sans-serif; font-size: 1.8rem; color: #263238; font-weight: 500;
            line-height: 2; margin-bottom: 25px;
            text-align: justify; text-indent: 50px; word-spacing: 0; letter-spacing: 0;
            word-break: normal; overflow-wrap: break-word;
        }

        /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏ó‡∏¢ */
        .thai-text {
            font-family: 'Sarabun', sans-serif; font-size: 1.3rem; color: #546e7a; font-weight: 300;
            line-height: 2;
            text-align: justify; text-indent: 50px;
            word-break: normal; overflow-wrap: break-word;
            transition: opacity 0.3s ease; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏á‡∏´‡∏≤‡∏¢ */
            opacity: 1; /* ‡∏Ñ‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏∑‡∏≠‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô */
        }

        /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        .thai-text.hidden {
            opacity: 0;       /* ‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô */
            user-select: none; /* ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏≥ (‡∏Å‡∏±‡∏ô‡πÇ‡∏Å‡∏á) */
            pointer-events: none; /* ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏•‡∏¥‡∏Å */
        }

        /* --- CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ô‡∏ò‡∏¥/‡πÑ‡∏ß‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå --- */
        .word-span.has-info {
            border-bottom: 2px dotted #aaa; /* ‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏∞‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏à‡∏≤‡∏á‡πÜ ‡∏ö‡∏≠‡∏Å‡πÉ‡∏ö‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
        }
        /* ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏∞‡∏ï‡∏≤‡∏° */
        .word-span.has-info.translated {
            border-bottom: 2px dotted #1565C0;
        }

        /* --- ‡∏Å‡∏•‡πà‡∏≠‡∏á Tooltip (‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏ö‡∏ó) --- */
        #sandhi-tooltip {
            position: fixed; /* ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á */
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
            background-color: #37474f; /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏° */
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-family: 'Sarabun', sans-serif;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 2000;
            pointer-events: none; /* ‡πÉ‡∏´‡πâ‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ó‡∏∞‡∏•‡∏∏‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏î */
            white-space: nowrap; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
            border: 1px solid #546e7a;
        }
        /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô Tooltip */
        #sandhi-tooltip span.split {
            color: #ffca28; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ó‡∏≠‡∏á ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡πÅ‡∏•‡πâ‡∏ß */
            font-weight: bold;
        }
        #sandhi-tooltip span.origin {
            color: #b0bec5; /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏≤ */
            font-size: 0.9em;
            margin-left: 5px;
        }

        .divider { width: 50px; height: 4px; background-color: #cfd8dc; border-radius: 2px; margin: 0 auto 25px auto; flex-shrink: 0; }
        .footer-box { background-color: #f7f9f9; border-top: 1px solid #eceff1; height: 150px; display: flex; padding: 0; flex-shrink: 0; }
        .footer-section { flex: 1; padding: 15px 25px; border-right: 1px solid #eceff1; display: flex; flex-direction: column; text-align: left; overflow-y: auto; }
        .footer-section:last-child { border-right: none; }
        .sec-title { font-size: 0.8rem; font-weight: 700; color: #90a4ae; text-transform: uppercase; margin-bottom: 8px; border-bottom: 1px solid #cfd8dc; padding-bottom: 3px; }
        .sec-content { font-size: 0.95rem; color: #37474f; line-height: 1.5; }
        .pali-word { font-family: 'Sarabun', sans-serif; color: #0277bd; font-weight: 500; }
        
        .page-badge { position: absolute; top: 20px; right: 20px; background-color: rgba(236, 239, 241, 0.9); padding: 6px 12px; border-radius: 8px; font-size: 0.9rem; color: #78909c; font-weight: bold; z-index: 10; }
        
        .controls { position: fixed; bottom: 25px; display: flex; gap: 20px; z-index: 100; }
        button { padding: 12px 30px; background-color: #455a64; border: none; border-radius: 50px; font-family: 'Sarabun', sans-serif; font-size: 1rem; font-weight: 600; color: #ffffff; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: all 0.3s ease; }
        button:hover { background-color: #607d8b; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.25); }

        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .animate-content { animation: slideIn 0.4s ease-out forwards; }
        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ (‡∏£‡∏π‡∏õ‡∏ï‡∏≤) */
        
        .tool-btn { 
            position: absolute; 
            top: 20px; 
            
            /* ‡∏•‡∏ö right: 100px ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
            
            padding: 8px 12px; 
            border-radius: 8px; 
            z-index: 20; 
            background-color: #eceff1; 
            color: #546e7a; 
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡∏ô‡∏π‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
        }
        
        .tool-btn:hover { 
            background-color: #cfd8dc; 
        }

        /* --- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô (‡πÉ‡∏´‡πâ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏ß‡∏≤‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô) --- */
        
        /* ‡∏õ‡∏∏‡πà‡∏° Note (‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î ‡∏ñ‡∏±‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤) */
        #btn-add-note { 
            right: 120px; /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ */
        } 
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≤ (‡∏≠‡∏¢‡∏π‡πà‡∏ñ‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° Note ‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢) */
        #btn-toggle-thai { 
            right: 170px; /* ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° Note 50px */
        }

        @media screen and (max-width: 768px) {
            .card { height: 90vh; margin-top: -40px; }
            .content-area { padding: 60px 20px 40px 20px; }
            .pali-text { font-size: 1.4rem; margin-bottom: 15px; }
            .thai-text { font-size: 1.2rem; }
            .footer-box { height: auto; flex-direction: column; overflow-y: auto; min-height: 120px; max-height: 30%; }
            .footer-section { border-right: none; border-bottom: 1px solid #eceff1; padding: 10px 20px; }
            .controls { bottom: 10px; gap: 10px; }
            button { padding: 10px 20px; font-size: 0.9rem; }
            .page-badge { right: 15px; top: 15px; } /* ‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤ */
            
            /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡∏î‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
            #btn-add-note { right: 90px; top: 15px; } 
            #btn-toggle-thai { right: 140px; top: 15px; }
        }

        /* --- CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Sticky Note (‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÇ‡∏ô‡πâ‡∏ï) --- */
        .sticky-note {
            position: absolute;
            background: #fff9c4; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô */
            border: 1px solid #fbc02d;
            padding: 10px;
            min-width: 150px;
            max-width: 250px;
            border-radius: 5px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.2);
            z-index: 100; /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
            font-size: 1rem;
            color: #333;
            cursor: move; /* ‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏¢‡πâ‡∏≤‡∏¢ */
            font-family: 'Sarabun', sans-serif;
        }
        .sticky-note:focus { outline: 2px solid #2980b9; }
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡πÇ‡∏ô‡πâ‡∏ï */
        .close-note {
            position: absolute; top: -8px; right: -8px;
            background: #e74c3c; color: white;
            border-radius: 50%; width: 20px; height: 20px;
            text-align: center; line-height: 20px;
            font-size: 12px; cursor: pointer; display: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        .sticky-note:hover .close-note { display: block; }
    </style>
</head>
<body>

    <div class="card" id="cardContainer">
        <div class="header-bar"></div>
        <div class="page-badge" id="pageNumber">1</div>
        
        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≤ (‡∏ã‡πâ‡∏≤‡∏¢) -->
        <button class="tool-btn" id="btn-toggle-thai" title="‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•" onclick="toggleThai()">
            <i class="fa-solid fa-eye"></i>
        </button>

        <!-- ‡∏õ‡∏∏‡πà‡∏° Note (‡∏Ç‡∏ß‡∏≤) -->
        <button class="tool-btn" id="btn-add-note" title="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (Note)" onclick="addNote()">
            <i class="fa-solid fa-note-sticky"></i>
        </button>
        
        <div class="content-area animate-content" id="mainContent">
            <!-- ID ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏î‡∏¢ JavaScript ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ó‡∏£‡∏Å‡∏Ñ‡∏≥ -->
            <div class="pali-text" id="paliContent">...</div>
            <div class="divider"></div>
            <div class="thai-text" id="thaiContent">...</div>
        </div>

        <div class="footer-box">
            <div class="footer-section" style="flex: 1.2;">
                <div class="sec-title">üìù ‡∏ö‡∏£‡∏¥‡∏ö‡∏ó / ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</div>
                <div class="sec-content" id="contextContent">...</div>
            </div>
            <div class="footer-section" style="flex: 0.8;">
                <div class="sec-title">üîπ ‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏≠‡∏≤‡∏Ç‡∏¢‡∏≤‡∏ï (‡∏Ñ‡∏∏‡∏°‡∏û‡∏≤‡∏Å‡∏¢‡πå)</div>
                <div class="sec-content pali-word" id="akhyataContent">...</div>
            </div>
            <div class="footer-section" style="flex: 1;">
                <div class="sec-title">üî∏ ‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏Å‡∏¥‡∏ï‡∏Å‡πå / ‡∏ï ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢</div>
                <div class="sec-content pali-word" id="kitakaContent">...</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button onclick="prevSlide()">‚ùÆ ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button onclick="resetHighlights()" style="background-color: #e57373;">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <button onclick="nextSlide()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ùØ</button>
    </div>

    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á Tooltip ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ô‡∏ò‡∏¥ -->
    <div id="sandhi-tooltip"></div>

    <script src="slides-data.js"></script>

    <script>
        const params = new URLSearchParams(window.location.search);
        const slideId = params.get('id');

        let slides = [];
        if (slideId && typeof slidesDatabase !== 'undefined' && slidesDatabase[slideId]) {
            slides = slidesDatabase[slideId];
        } else {
            slides = [{ pali: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô", thai: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™ (ID)", context: "-", akhyata: "-", kitaka: "-" }];
        }

        let currentIndex = 0;
        const mainContent = document.getElementById('mainContent');
        const contentArea = document.querySelector('.content-area');
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡πÜ (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Ñ‡∏≥‡∏î‡πâ‡∏ß‡∏¢ _)
        function wrapWords(text, vocabData) {
            if (!text) return "";
            
            return text.split(' ').map(word => {
                if (word.trim() === "") return "";
                
                // 1. ‡πÅ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤-‡∏´‡∏•‡∏±‡∏á (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
                const parts = word.match(/^([‚Äú"'(]*)(.+?)([)‚Äù"'.‡∏Ø,;:?]+)?$/);
                
                let prefix = "";
                let cleanWord = word;
                let suffix = "";
                
                if (parts) {
                    prefix = parts[1] || "";
                    cleanWord = parts[2];
                    suffix = parts[3] || "";
                }

                // 2. *** ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà: ‡πÅ‡∏õ‡∏•‡∏á _ ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ***
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á)
                let displayText = cleanWord.replace(/_/g, ' '); 
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô Vocab (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô vocab ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ‡∏Å‡πá‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ)
                let searchKey = displayText; 
                
                // ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô vocab ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏°‡∏µ _ ‡∏Å‡πá‡πÉ‡∏ä‡πâ cleanWord (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ displayText ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏á‡πà‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤)

                // 3. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                let vocabInfo = "";
                let hasInfoClass = "";
                
                if (vocabData && vocabData[searchKey]) {
                    vocabInfo = `data-sandhi="${vocabData[searchKey]}"`;
                    hasInfoClass = "has-info";
                }

                // 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML
                return `${prefix}<span class="word-span ${hasInfoClass}" 
                              ${vocabInfo}
                              onmouseenter="showTooltip(this)" 
                              onmouseleave="hideTooltip()"
                              onclick="toggleHighlight(this)">${displayText}</span>${suffix}`;
            }).join(' ');
        }


        // --- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏• ---
        let isThaiHidden = false;

        function toggleThai() {
            isThaiHidden = !isThaiHidden;
            applyThaiState();
        }

        function applyThaiState() {
            const thaiElem = document.getElementById('thaiContent');
            // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô selector ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏à‡∏£‡∏¥‡∏á ***
            // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ id="btn-toggle-thai" ‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏° ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ú‡πà‡∏≤‡∏ô onclick ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° ID
            // ‡πÅ‡∏ï‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏ú‡∏°‡∏Ç‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° ID ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö
            
            const btn = document.getElementById('btn-toggle-thai');
            const btnIcon = btn.querySelector('i');

            if (isThaiHidden) {
                thaiElem.classList.add('hidden');
                btnIcon.classList.remove('fa-eye');
                btnIcon.classList.add('fa-eye-slash');
                // btn.classList.add('active'); // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏∏‡πã‡∏°‡∏•‡∏á‡πÑ‡∏õ
            } else {
                thaiElem.classList.remove('hidden');
                btnIcon.classList.remove('fa-eye-slash');
                btnIcon.classList.add('fa-eye');
                // btn.classList.remove('active');
            }
        }

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Sticky Notes (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà) ---
        function addNote() {
            const card = document.getElementById('cardContainer'); // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å
            const note = document.createElement('div');
            note.className = 'sticky-note';
            note.contentEditable = true; // ‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ
            note.innerText = '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            
            // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            note.style.left = '50px';
            note.style.top = '100px';
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö
            const closeBtn = document.createElement('div');
            closeBtn.className = 'close-note';
            closeBtn.innerHTML = '&times;';
            closeBtn.contentEditable = false;
            closeBtn.onclick = function() { note.remove(); };
            
            note.appendChild(closeBtn);
            
            // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏Å‡πÑ‡∏î‡πâ
            makeDraggable(note);
            
            card.appendChild(note);
            note.focus(); // ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á‡πÑ‡∏î‡πâ
        function makeDraggable(el) {
            let isDragging = false;
            let startX, startY, initialLeft, initialTop;

            el.addEventListener('mousedown', function(e) {
                if (e.target.className === 'close-note') return; // ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏≤‡∏Å‡∏ñ‡πâ‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                initialLeft = el.offsetLeft;
                initialTop = el.offsetTop;
                el.style.zIndex = 1000; // ‡∏î‡∏±‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏ï‡∏≠‡∏ô‡∏•‡∏≤‡∏Å
            });

            window.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                e.preventDefault(); // ‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                el.style.left = `${initialLeft + dx}px`;
                el.style.top = `${initialTop + dy}px`;
            });

            window.addEventListener('mouseup', () => {
                isDragging = false;
                el.style.zIndex = 100; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ z-index
            });
            
            // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™ (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡πÑ‡∏≠‡πÅ‡∏û‡∏î)
            el.addEventListener('touchstart', function(e) {
                if (e.target.className === 'close-note') return;
                isDragging = true;
                const touch = e.touches[0];
                startX = touch.clientX;
                startY = touch.clientY;
                initialLeft = el.offsetLeft;
                initialTop = el.offsetTop;
            });
            
            window.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                const touch = e.touches[0];
                const dx = touch.clientX - startX;
                const dy = touch.clientY - startY;
                el.style.left = `${initialLeft + dx}px`;
                el.style.top = `${initialTop + dy}px`;
            });
             window.addEventListener('touchend', () => isDragging = false);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡πÇ‡∏ô‡πâ‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡πÑ‡∏•‡∏î‡πå)
        function removeAllNotes() {
            document.querySelectorAll('.sticky-note').forEach(n => n.remove());
        }

        function updateSlide() {
            if (typeof removeAllNotes === 'function') removeAllNotes(); 
            mainContent.classList.remove('animate-content');
            mainContent.classList.remove('animate-content');
            void mainContent.offsetWidth; 
            mainContent.classList.add('animate-content');
            contentArea.scrollTop = 0;

            const s = slides[currentIndex];

            // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß: ‡∏™‡πà‡∏á s.vocab ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ ***
            document.getElementById('paliContent').innerHTML = wrapWords(s.pali, s.vocab);
            document.getElementById('thaiContent').innerHTML = wrapWords(s.thai);
            
            document.getElementById('contextContent').innerText = s.context;
            document.getElementById('akhyataContent').innerText = s.akhyata;
            document.getElementById('kitakaContent').innerText = s.kitaka;
            
            document.getElementById('pageNumber').innerText = `${currentIndex + 1} / ${slides.length}`;
            applyThaiState();
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Tooltip ---
        const tooltip = document.getElementById('sandhi-tooltip');

        function showTooltip(element) {
            const info = element.getAttribute('data-sandhi');
            if (!info) return;

            // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            let formattedInfo = info;
            if (info.includes('(')) {
                const parts = info.split('(');
                formattedInfo = `<span class="split">${parts[0]}</span> <span class="origin">(${parts[1]}</span>`;
            } else {
                formattedInfo = `<span class="split">${info}</span>`;
            }

            tooltip.innerHTML = formattedInfo;
            tooltip.style.display = 'block';

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏Ñ‡∏≥)
            const rect = element.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            
            let top = rect.top - tooltipRect.height - 10; 
            let left = rect.left + (rect.width / 2) - (tooltipRect.width / 2); 

            // ‡∏Å‡∏±‡∏ô‡∏ï‡∏Å‡∏Ç‡∏≠‡∏ö‡∏à‡∏≠
            if (top < 0) top = rect.bottom + 10; 
            if (left < 10) left = 10;
            
            tooltip.style.top = `${top}px`;
            tooltip.style.left = `${left}px`;
        }

        function hideTooltip() {
            tooltip.style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥)
        window.toggleHighlight = function(element) {
            element.classList.toggle('translated');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ (‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï)
        window.resetHighlights = function() {
            document.querySelectorAll('.word-span').forEach(el => el.classList.remove('translated'));
        }

        function nextSlide() {
            if (currentIndex < slides.length - 1) {
                currentIndex++;
                updateSlide();
            }
        }

        function prevSlide() {
            if (currentIndex > 0) {
                currentIndex--;
                updateSlide();
            }
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === "ArrowRight") nextSlide();
            if (event.key === "ArrowLeft") prevSlide();
        });

        updateSlide();
    </script>
</body>
</html>